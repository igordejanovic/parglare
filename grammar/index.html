<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Igor Dejanović">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Grammar - parglare</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  <link href="../style.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Grammar";
    var mkdocs_page_input_path = "grammar.md";
    var mkdocs_page_url = "/grammar/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-68681917-1', 'igordejanovic.net');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> parglare</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>User Guide</span></li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Grammar</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#the-parglare-grammar-language">The parglare grammar language</a></li>
                
                    <li><a class="toctree-l4" href="#terminals">Terminals</a></li>
                
                    <li><a class="toctree-l4" href="#usual-patterns">Usual patterns</a></li>
                
                    <li><a class="toctree-l4" href="#grammar-comments">Grammar comments</a></li>
                
                    <li><a class="toctree-l4" href="#handling-whitespaces-and-comments">Handling whitespaces and comments</a></li>
                
            
            </ul>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>About</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../about/CONTRIBUTING/">Contributing</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../about/LICENSE/">License</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">parglare</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>User Guide &raquo;</li>
        
      
    
    <li>Grammar</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/igordejanovic/parglare/edit/master/docs/grammar.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="the-parglare-grammar-language">The parglare grammar language<a class="headerlink" href="#the-parglare-grammar-language" title="Permanent link">&para;</a></h1>
<p>parglare grammar specification language is based
on <a href="https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form">BNF</a>. parglare is
based
on
<a href="https://en.wikipedia.org/wiki/Context-free_grammar">Context-Free Grammars (CFGs)</a> and
grammar is given declaratively. You don't have to think about the parsing
process like in
e.g. <a href="https://en.wikipedia.org/wiki/Parsing_expression_grammar">PEGs</a>.
Ambiguities are dealt with explicitely (see section on conflicts...).</p>
<p>Grammar consists of a set of derivation rules where each rule is of the form:</p>
<pre><code>&lt;symbol&gt; = &lt;expression&gt; ;
</code></pre>

<p>where <code>&lt;symbol&gt;</code> is grammar non-terminal and <code>&lt;expression&gt;</code> is a sequence of
terminals and non-terminals separated by choice operator <code>|</code>.</p>
<p>For example:</p>
<pre><code>Fields = Field | Fields &quot;,&quot; Field;
</code></pre>

<p>Here <code>Fields</code> is a non-terminal grammar symbol and it is defined as either a
single <code>Field</code> or, recursively, as <code>Fields</code> followed by a string terminal <code>,</code>
and than by another <code>Field</code>. It is not given here but <code>Field</code> could also be
defined as a non-terminal. For example:</p>
<pre><code>Field = QuotedField | FieldContent;
</code></pre>

<p>Or it could be defined as a terminal:</p>
<pre><code>Field = /[A-Z]*/
</code></pre>

<p>This terminal definition uses regular expression recognizer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you got use to various BNF extensions
(like <a href="https://en.wikipedia.org/wiki/Kleene_star">Kleene star</a>) you might find
this awkward because you must build <code>zero or more</code> or <code>one or more</code> pattern from
scratch using just a sequence, choice and recursion. The grammars are indeed
more verbose but, on the other hand, actions are much easier to write and you
have full control over tree construction process. parglare might provide some
syntactic sugar later that would make some constructs shorter to write.</p>
</div>
<h2 id="terminals">Terminals<a class="headerlink" href="#terminals" title="Permanent link">&para;</a></h2>
<p>Terminal symbols of the grammar define the fundamental and atomic elements of
your language -- tokens or lexemes (e.g. keywords, numbers). In parglare
terminal is connected to recognizer which is an object used to recognize token
of particular type in the input. Most of the time you will do parsing of textual
content and you will need textual recognizers. These recognizers are built-in
and there are two type of textual recognizers:</p>
<ul>
<li>string recognizer</li>
<li>regular expression recognizer</li>
</ul>
<h3 id="string-recognizer">String recognizer<a class="headerlink" href="#string-recognizer" title="Permanent link">&para;</a></h3>
<p>String recognizer is defined as a plain string inside of double quotes:</p>
<h3 id="regular-expression-recognizer">Regular expression recognizer<a class="headerlink" href="#regular-expression-recognizer" title="Permanent link">&para;</a></h3>
<p>Or regex recognizer for short is a regex pattern written inside slashes
(<code>/.../</code>).</p>
<p>For example:</p>
<pre><code> number = /\d+/;
</code></pre>
<p>This rule defines terminal symbol <code>number</code> which has a regex recognizer and will
recognize one or more digits as a number.</p>
<h3 id="custom-recognizers">Custom recognizers<a class="headerlink" href="#custom-recognizers" title="Permanent link">&para;</a></h3>
<p>If you are parsing arbitrary input (non-textual) you'll have to provide your own
recognizers. In the grammar, you just have to reference your token symbol but
you don't have to provide the definition. You will provide missing recognizers
during grammar instantiation.</p>
<p>Lets say that we have a list of integers (real list of Python ints, not a text
with numbers) and we have some weird requirement to break those numbers
according to the following grammar:</p>
<pre><code>  Numbers = all_less_than_five ascending all_less_than_five EOF;
  all_less_than_five = all_less_than_five int_less_than_five
                     | int_less_than_five;
</code></pre>
<p>So, we should first match all numbers less than five and collect those, than we
should match a list of ascending numbers and than list of less than five again.
<code>int_less_than_five</code> and <code>ascending</code> are terminals/recognizers that will be
defined in Python and passed to grammar construction. <code>int_less_than_five</code> will
recognize Python integer that is less than five. <code>ascending</code> will recognize a
sublist of integers in ascending order.</p>
<p>More on this topic will be written in a separate section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can directly write regex or string recognizer at the place of terminal:</p>
<pre><code>some_rule = "a" aterm "a";
aterm = "a";
</code></pre>
<p>Writting <code>"a"</code> in <code>some_rule</code> is equivalent to writing terminal reference
<code>aterm</code>. Rule <code>aterm</code> is terminal definition rule. All occurences of <code>"a"</code>
as well as <code>aterm</code> will result in the same terminal in the grammar.</p>
</div>
<h2 id="usual-patterns">Usual patterns<a class="headerlink" href="#usual-patterns" title="Permanent link">&para;</a></h2>
<h3 id="one-or-more">One or more<a class="headerlink" href="#one-or-more" title="Permanent link">&para;</a></h3>
<pre><code>document = sections;
// sections rule bellow will match one or more section.
sections = sections section | section;
</code></pre>
<p>In this example <code>sections</code> will match one or more <code>section</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware that you could do the same with this rule:</p>
<pre><code>sections = section sections | section;
</code></pre>
<p>which will give you similar result but the resulting tree will be different.
Former example will reduce sections early and than add another section to it,
thus the tree will be expanding to the left. The later example will collect all
the sections and than start reducing from the end, thus building a tree
expanding to the right. These are subtle differences that are important when you
start writing your semantic actions. Most of the time you don't care about this
so use the first version as it is slightly efficient and parglare provides
common actions for these common cases.</p>
</div>
<h3 id="zero-or-more">Zero or more<a class="headerlink" href="#zero-or-more" title="Permanent link">&para;</a></h3>
<pre><code>document = sections;
// sections rule bellow will match zero or more section.
sections = sections section | section | EMPTY;
</code></pre>
<p>In this example <code>sections</code> will match zero or more <code>section</code>. Notice the
addition of the <code>EMPTY</code> choice at the end. This means that matching nothing is a
valid <code>sections</code> non-terminal.</p>
<p>Same note from above applies here to.</p>
<h3 id="optional">Optional<a class="headerlink" href="#optional" title="Permanent link">&para;</a></h3>
<pre><code>document = optheader body;
optheader = header | EMPTY;
</code></pre>
<p>In this example <code>optheader</code> is either a header or nothing.</p>
<h2 id="grammar-comments">Grammar comments<a class="headerlink" href="#grammar-comments" title="Permanent link">&para;</a></h2>
<p>In grammar comments are available as both line comments and block comments:</p>
<pre><code>// This is a line comment. Everything from the '//' to the end of line is a comment.

/*
  This is a block comment.
  Everything in between `/*`  and '*/' is a comment.
*/
</code></pre>
<h2 id="handling-whitespaces-and-comments">Handling whitespaces and comments<a class="headerlink" href="#handling-whitespaces-and-comments" title="Permanent link">&para;</a></h2>
<p>By default parser will skip whitespaces. Whitespace skipping is controlled by
<code>ws</code> parameter to the parser which is by default set to <code>'\n\t '</code>.</p>
<p>If you need more control of the layout, i.e. handling of not only whitespaces by
comments also, you can use a special rule <code>LAYOUT</code>:</p>
<pre><code>  LAYOUT = LayoutItem | LAYOUT LayoutItem;
  LayoutItem = WS | Comment | EMPTY;
  WS = /\s+/;
  Comment = /\/\/.*/;
</code></pre>
<p>This will form a separate layout parser that will parse in-between each matched
tokens. In this example spaces and line-comments will get consumed by the layout
parser.</p>
<p>If this special rule is found in the grammar <code>ws</code> parser parameter is ignored.</p>
<p>Another example that gives support for both line comments and block comments
like the one used in the grammar language itself:</p>
<pre><code>  LAYOUT = LayoutItem | LAYOUT LayoutItem;
  LayoutItem = WS | Comment | EMPTY;
  WS = /\s+/;
  Comment = '/*' CorNCs '*/' | /\/\/.*/;
  CorNCs = CorNC | CorNCs CorNC | EMPTY;
  CorNC = Comment | NotComment | WS;
  NotComment = /((\*[^\/])|[^\s*\/]|\/[^\*])+/;
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../about/CONTRIBUTING/" class="btn btn-neutral float-right" title="Contributing">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2017 <a href="http://igordejanovic.net/">Igor Dejanović</a>.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/igordejanovic/parglare" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../about/CONTRIBUTING/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
